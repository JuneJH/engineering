{"remainingRequest":"/Users/june/Desktop/work/engineering/node_modules/thread-loader/dist/cjs.js!/Users/june/Desktop/work/engineering/node_modules/babel-loader/lib/index.js!/Users/june/Desktop/work/engineering/node_modules/webpack-dev-server/client/modules/logger/index.js","dependencies":[{"path":"/Users/june/Desktop/work/engineering/node_modules/webpack-dev-server/client/modules/logger/index.js","mtime":499162500000},{"path":"/Users/june/Desktop/work/engineering/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/june/Desktop/work/engineering/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/june/Desktop/work/engineering/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqKioqKi8oZnVuY3Rpb24gKCkgewogIC8vIHdlYnBhY2tCb290c3RyYXAKICAvKioqKioqLwogICJ1c2Ugc3RyaWN0IjsKCiAgLyoqKioqKi8KICB2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9IHsKICAgIC8qKiovIi4vY2xpZW50LXNyYy9tb2R1bGVzL2xvZ2dlci9TeW5jQmFpbEhvb2tGYWtlLmpzIjoKICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAgICAgISoqKiAuL2NsaWVudC1zcmMvbW9kdWxlcy9sb2dnZXIvU3luY0JhaWxIb29rRmFrZS5qcyAqKiohCiAgICAgIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLyoqKi8KICAgIGZ1bmN0aW9uIChtb2R1bGUpIHsKICAgICAgLyoqCiAgICAgICAqIENsaWVudCBzdHViIGZvciB0YXBhYmxlIFN5bmNCYWlsSG9vawogICAgICAgKi8KCiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY2xpZW50VGFwYWJsZVN5bmNCYWlsSG9vaygpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgY2FsbDogZnVuY3Rpb24gY2FsbCgpIHt9CiAgICAgICAgfTsKICAgICAgfTsKCiAgICAgIC8qKiovCiAgICB9LAoKICAgIC8qKiovIi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvTG9nZ2VyLmpzIjoKICAgIC8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAgICAgISoqKiAuL25vZGVfbW9kdWxlcy93ZWJwYWNrL2xpYi9sb2dnaW5nL0xvZ2dlci5qcyAqKiohCiAgICAgIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLyoqKi8KICAgIGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgewogICAgICAvKgogICAgICAJTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHAKICAgICAgCUF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmEKICAgICAgKi8KCiAgICAgIGZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICAgICAgICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7CiAgICAgICAgaWYgKCFvKSByZXR1cm47CiAgICAgICAgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7CiAgICAgICAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOwogICAgICAgIGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOwogICAgICAgIGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7CiAgICAgICAgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICAgICAgICBpZiAodHlwZW9mICh0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiA/IFN5bWJvbCA6IGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICByZXR1cm4gaTsKICAgICAgICB9KSAhPT0gInVuZGVmaW5lZCIgJiYgaXRlclsodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgPyBTeW1ib2wgOiBmdW5jdGlvbiAoaSkgewogICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfSkuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlclsiQEBpdGVyYXRvciJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkoYXJyKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgewogICAgICAgIGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOwogICAgICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFycjI7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogICAgICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICAgICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICAgICAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogICAgICAgIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogICAgICAgIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsICJwcm90b3R5cGUiLCB7CiAgICAgICAgICB3cml0YWJsZTogZmFsc2UKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gQ29uc3RydWN0b3I7CiAgICAgIH0KICAgICAgdmFyIExvZ1R5cGUgPSBPYmplY3QuZnJlZXplKHsKICAgICAgICBlcnJvcjogLyoqIEB0eXBlIHsiZXJyb3IifSAqLwogICAgICAgICJlcnJvciIsCiAgICAgICAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHMKICAgICAgICB3YXJuOiAvKiogQHR5cGUgeyJ3YXJuIn0gKi8KICAgICAgICAid2FybiIsCiAgICAgICAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHMKICAgICAgICBpbmZvOiAvKiogQHR5cGUgeyJpbmZvIn0gKi8KICAgICAgICAiaW5mbyIsCiAgICAgICAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHMKICAgICAgICBsb2c6IC8qKiBAdHlwZSB7ImxvZyJ9ICovCiAgICAgICAgImxvZyIsCiAgICAgICAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHMKICAgICAgICBkZWJ1ZzogLyoqIEB0eXBlIHsiZGVidWcifSAqLwogICAgICAgICJkZWJ1ZyIsCiAgICAgICAgLy8gbWVzc2FnZSwgYyBzdHlsZSBhcmd1bWVudHMKICAgICAgICB0cmFjZTogLyoqIEB0eXBlIHsidHJhY2UifSAqLwogICAgICAgICJ0cmFjZSIsCiAgICAgICAgLy8gbm8gYXJndW1lbnRzCiAgICAgICAgZ3JvdXA6IC8qKiBAdHlwZSB7Imdyb3VwIn0gKi8KICAgICAgICAiZ3JvdXAiLAogICAgICAgIC8vIFtsYWJlbF0KICAgICAgICBncm91cENvbGxhcHNlZDogLyoqIEB0eXBlIHsiZ3JvdXBDb2xsYXBzZWQifSAqLwogICAgICAgICJncm91cENvbGxhcHNlZCIsCiAgICAgICAgLy8gW2xhYmVsXQogICAgICAgIGdyb3VwRW5kOiAvKiogQHR5cGUgeyJncm91cEVuZCJ9ICovCiAgICAgICAgImdyb3VwRW5kIiwKICAgICAgICAvLyBbbGFiZWxdCiAgICAgICAgcHJvZmlsZTogLyoqIEB0eXBlIHsicHJvZmlsZSJ9ICovCiAgICAgICAgInByb2ZpbGUiLAogICAgICAgIC8vIFtwcm9maWxlTmFtZV0KICAgICAgICBwcm9maWxlRW5kOiAvKiogQHR5cGUgeyJwcm9maWxlRW5kIn0gKi8KICAgICAgICAicHJvZmlsZUVuZCIsCiAgICAgICAgLy8gW3Byb2ZpbGVOYW1lXQogICAgICAgIHRpbWU6IC8qKiBAdHlwZSB7InRpbWUifSAqLwogICAgICAgICJ0aW1lIiwKICAgICAgICAvLyBuYW1lLCB0aW1lIGFzIFtzZWNvbmRzLCBuYW5vc2Vjb25kc10KICAgICAgICBjbGVhcjogLyoqIEB0eXBlIHsiY2xlYXIifSAqLwogICAgICAgICJjbGVhciIsCiAgICAgICAgLy8gbm8gYXJndW1lbnRzCiAgICAgICAgc3RhdHVzOiAvKiogQHR5cGUgeyJzdGF0dXMifSAqLwogICAgICAgICJzdGF0dXMiIC8vIG1lc3NhZ2UsIGFyZ3VtZW50cwogICAgICB9KTsKCiAgICAgIGV4cG9ydHMuTG9nVHlwZSA9IExvZ1R5cGU7CiAgICAgIC8qKiBAdHlwZWRlZiB7dHlwZW9mIExvZ1R5cGVba2V5b2YgdHlwZW9mIExvZ1R5cGVdfSBMb2dUeXBlRW51bSAqLwoKICAgICAgdmFyIExPR19TWU1CT0wgPSAodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgPyBTeW1ib2wgOiBmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpOwogICAgICB9KSgid2VicGFjayBsb2dnZXIgcmF3IGxvZyBtZXRob2QiKTsKICAgICAgdmFyIFRJTUVSU19TWU1CT0wgPSAodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgPyBTeW1ib2wgOiBmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpOwogICAgICB9KSgid2VicGFjayBsb2dnZXIgdGltZXMiKTsKICAgICAgdmFyIFRJTUVSU19BR0dSRUdBVEVTX1NZTUJPTCA9ICh0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiA/IFN5bWJvbCA6IGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0pKCJ3ZWJwYWNrIGxvZ2dlciBhZ2dyZWdhdGVkIHRpbWVzIik7CiAgICAgIHZhciBXZWJwYWNrTG9nZ2VyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAvKioKICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKExvZ1R5cGVFbnVtLCBhbnlbXT0pOiB2b2lkfSBsb2cgbG9nIGZ1bmN0aW9uCiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcgfCBmdW5jdGlvbigpOiBzdHJpbmcpOiBXZWJwYWNrTG9nZ2VyfSBnZXRDaGlsZExvZ2dlciBmdW5jdGlvbiB0byBjcmVhdGUgY2hpbGQgbG9nZ2VyCiAgICAgICAgICovCiAgICAgICAgZnVuY3Rpb24gV2VicGFja0xvZ2dlcihsb2csIGdldENoaWxkTG9nZ2VyKSB7CiAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2VicGFja0xvZ2dlcik7CiAgICAgICAgICB0aGlzW0xPR19TWU1CT0xdID0gbG9nOwogICAgICAgICAgdGhpcy5nZXRDaGlsZExvZ2dlciA9IGdldENoaWxkTG9nZ2VyOwogICAgICAgIH0KICAgICAgICBfY3JlYXRlQ2xhc3MoV2VicGFja0xvZ2dlciwgW3sKICAgICAgICAgIGtleTogImVycm9yIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlcnJvcigpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuZXJyb3IsIGFyZ3MpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogIndhcm4iLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdhcm4oKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykgewogICAgICAgICAgICAgIGFyZ3NbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUud2FybiwgYXJncyk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAiaW5mbyIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5mbygpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4zKSwgX2tleTMgPSAwOyBfa2V5MyA8IF9sZW4zOyBfa2V5MysrKSB7CiAgICAgICAgICAgICAgYXJnc1tfa2V5M10gPSBhcmd1bWVudHNbX2tleTNdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5pbmZvLCBhcmdzKTsKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJsb2ciLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvZygpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2xlbjQgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW40KSwgX2tleTQgPSAwOyBfa2V5NCA8IF9sZW40OyBfa2V5NCsrKSB7CiAgICAgICAgICAgICAgYXJnc1tfa2V5NF0gPSBhcmd1bWVudHNbX2tleTRdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5sb2csIGFyZ3MpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogImRlYnVnIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZWJ1ZygpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2xlbjUgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW41KSwgX2tleTUgPSAwOyBfa2V5NSA8IF9sZW41OyBfa2V5NSsrKSB7CiAgICAgICAgICAgICAgYXJnc1tfa2V5NV0gPSBhcmd1bWVudHNbX2tleTVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5kZWJ1ZywgYXJncyk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAiYXNzZXJ0IiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhc3NlcnQoYXNzZXJ0aW9uKSB7CiAgICAgICAgICAgIGlmICghYXNzZXJ0aW9uKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgX2xlbjYgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW42ID4gMSA/IF9sZW42IC0gMSA6IDApLCBfa2V5NiA9IDE7IF9rZXk2IDwgX2xlbjY7IF9rZXk2KyspIHsKICAgICAgICAgICAgICAgIGFyZ3NbX2tleTYgLSAxXSA9IGFyZ3VtZW50c1tfa2V5Nl07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5lcnJvciwgYXJncyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJ0cmFjZSIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdHJhY2UoKSB7CiAgICAgICAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS50cmFjZSwgWyJUcmFjZSJdKTsKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJjbGVhciIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXIoKSB7CiAgICAgICAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5jbGVhcik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAic3RhdHVzIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGF0dXMoKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9sZW43ID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuNyksIF9rZXk3ID0gMDsgX2tleTcgPCBfbGVuNzsgX2tleTcrKykgewogICAgICAgICAgICAgIGFyZ3NbX2tleTddID0gYXJndW1lbnRzW19rZXk3XTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuc3RhdHVzLCBhcmdzKTsKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJncm91cCIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ3JvdXAoKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9sZW44ID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuOCksIF9rZXk4ID0gMDsgX2tleTggPCBfbGVuODsgX2tleTgrKykgewogICAgICAgICAgICAgIGFyZ3NbX2tleThdID0gYXJndW1lbnRzW19rZXk4XTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuZ3JvdXAsIGFyZ3MpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogImdyb3VwQ29sbGFwc2VkIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBncm91cENvbGxhcHNlZCgpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2xlbjkgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW45KSwgX2tleTkgPSAwOyBfa2V5OSA8IF9sZW45OyBfa2V5OSsrKSB7CiAgICAgICAgICAgICAgYXJnc1tfa2V5OV0gPSBhcmd1bWVudHNbX2tleTldOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXNbTE9HX1NZTUJPTF0oTG9nVHlwZS5ncm91cENvbGxhcHNlZCwgYXJncyk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAiZ3JvdXBFbmQiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdyb3VwRW5kKCkgewogICAgICAgICAgICBmb3IgKHZhciBfbGVuMTAgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4xMCksIF9rZXkxMCA9IDA7IF9rZXkxMCA8IF9sZW4xMDsgX2tleTEwKyspIHsKICAgICAgICAgICAgICBhcmdzW19rZXkxMF0gPSBhcmd1bWVudHNbX2tleTEwXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUuZ3JvdXBFbmQsIGFyZ3MpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInByb2ZpbGUiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByb2ZpbGUobGFiZWwpIHsKICAgICAgICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLnByb2ZpbGUsIFtsYWJlbF0pOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInByb2ZpbGVFbmQiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByb2ZpbGVFbmQobGFiZWwpIHsKICAgICAgICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLnByb2ZpbGVFbmQsIFtsYWJlbF0pOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInRpbWUiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRpbWUobGFiZWwpIHsKICAgICAgICAgICAgdGhpc1tUSU1FUlNfU1lNQk9MXSA9IHRoaXNbVElNRVJTX1NZTUJPTF0gfHwgbmV3IE1hcCgpOwogICAgICAgICAgICB0aGlzW1RJTUVSU19TWU1CT0xdLnNldChsYWJlbCwgcHJvY2Vzcy5ocnRpbWUoKSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAga2V5OiAidGltZUxvZyIsCiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdGltZUxvZyhsYWJlbCkgewogICAgICAgICAgICB2YXIgcHJldiA9IHRoaXNbVElNRVJTX1NZTUJPTF0gJiYgdGhpc1tUSU1FUlNfU1lNQk9MXS5nZXQobGFiZWwpOwogICAgICAgICAgICBpZiAoIXByZXYpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk5vIHN1Y2ggbGFiZWwgJyIuY29uY2F0KGxhYmVsLCAiJyBmb3IgV2VicGFja0xvZ2dlci50aW1lTG9nKCkiKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHRpbWUgPSBwcm9jZXNzLmhydGltZShwcmV2KTsKICAgICAgICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLnRpbWUsIFtsYWJlbF0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheSh0aW1lKSkpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInRpbWVFbmQiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRpbWVFbmQobGFiZWwpIHsKICAgICAgICAgICAgdmFyIHByZXYgPSB0aGlzW1RJTUVSU19TWU1CT0xdICYmIHRoaXNbVElNRVJTX1NZTUJPTF0uZ2V0KGxhYmVsKTsKICAgICAgICAgICAgaWYgKCFwcmV2KSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJObyBzdWNoIGxhYmVsICciLmNvbmNhdChsYWJlbCwgIicgZm9yIFdlYnBhY2tMb2dnZXIudGltZUVuZCgpIikpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciB0aW1lID0gcHJvY2Vzcy5ocnRpbWUocHJldik7CiAgICAgICAgICAgIHRoaXNbVElNRVJTX1NZTUJPTF0uZGVsZXRlKGxhYmVsKTsKICAgICAgICAgICAgdGhpc1tMT0dfU1lNQk9MXShMb2dUeXBlLnRpbWUsIFtsYWJlbF0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheSh0aW1lKSkpOwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIGtleTogInRpbWVBZ2dyZWdhdGUiLAogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRpbWVBZ2dyZWdhdGUobGFiZWwpIHsKICAgICAgICAgICAgdmFyIHByZXYgPSB0aGlzW1RJTUVSU19TWU1CT0xdICYmIHRoaXNbVElNRVJTX1NZTUJPTF0uZ2V0KGxhYmVsKTsKICAgICAgICAgICAgaWYgKCFwcmV2KSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJObyBzdWNoIGxhYmVsICciLmNvbmNhdChsYWJlbCwgIicgZm9yIFdlYnBhY2tMb2dnZXIudGltZUFnZ3JlZ2F0ZSgpIikpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciB0aW1lID0gcHJvY2Vzcy5ocnRpbWUocHJldik7CiAgICAgICAgICAgIHRoaXNbVElNRVJTX1NZTUJPTF0uZGVsZXRlKGxhYmVsKTsKICAgICAgICAgICAgdGhpc1tUSU1FUlNfQUdHUkVHQVRFU19TWU1CT0xdID0gdGhpc1tUSU1FUlNfQUdHUkVHQVRFU19TWU1CT0xdIHx8IG5ldyBNYXAoKTsKICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzW1RJTUVSU19BR0dSRUdBVEVTX1NZTUJPTF0uZ2V0KGxhYmVsKTsKICAgICAgICAgICAgaWYgKGN1cnJlbnQgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIGlmICh0aW1lWzFdICsgY3VycmVudFsxXSA+IDFlOSkgewogICAgICAgICAgICAgICAgdGltZVswXSArPSBjdXJyZW50WzBdICsgMTsKICAgICAgICAgICAgICAgIHRpbWVbMV0gPSB0aW1lWzFdIC0gMWU5ICsgY3VycmVudFsxXTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGltZVswXSArPSBjdXJyZW50WzBdOwogICAgICAgICAgICAgICAgdGltZVsxXSArPSBjdXJyZW50WzFdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzW1RJTUVSU19BR0dSRUdBVEVTX1NZTUJPTF0uc2V0KGxhYmVsLCB0aW1lKTsKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBrZXk6ICJ0aW1lQWdncmVnYXRlRW5kIiwKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0aW1lQWdncmVnYXRlRW5kKGxhYmVsKSB7CiAgICAgICAgICAgIGlmICh0aGlzW1RJTUVSU19BR0dSRUdBVEVTX1NZTUJPTF0gPT09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgICAgICAgICB2YXIgdGltZSA9IHRoaXNbVElNRVJTX0FHR1JFR0FURVNfU1lNQk9MXS5nZXQobGFiZWwpOwogICAgICAgICAgICBpZiAodGltZSA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICAgICAgICAgIHRoaXNbVElNRVJTX0FHR1JFR0FURVNfU1lNQk9MXS5kZWxldGUobGFiZWwpOwogICAgICAgICAgICB0aGlzW0xPR19TWU1CT0xdKExvZ1R5cGUudGltZSwgW2xhYmVsXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRpbWUpKSk7CiAgICAgICAgICB9CiAgICAgICAgfV0pOwogICAgICAgIHJldHVybiBXZWJwYWNrTG9nZ2VyOwogICAgICB9KCk7CiAgICAgIGV4cG9ydHMuTG9nZ2VyID0gV2VicGFja0xvZ2dlcjsKCiAgICAgIC8qKiovCiAgICB9LAoKICAgIC8qKiovIi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvY3JlYXRlQ29uc29sZUxvZ2dlci5qcyI6CiAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICAgICAhKioqIC4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvY3JlYXRlQ29uc29sZUxvZ2dlci5qcyAqKiohCiAgICAgIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIC8qKiovCiAgICBmdW5jdGlvbiAobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgLyoKICAgICAgCU1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwCiAgICAgIAlBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhCiAgICAgICovCgogICAgICBmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgICAgICAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgewogICAgICAgIGlmICghbykgcmV0dXJuOwogICAgICAgIGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOwogICAgICAgIHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsKICAgICAgICBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsKICAgICAgICBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOwogICAgICAgIGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgICAgICAgaWYgKHR5cGVvZiAodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgPyBTeW1ib2wgOiBmdW5jdGlvbiAoaSkgewogICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfSkgIT09ICJ1bmRlZmluZWQiICYmIGl0ZXJbKHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiID8gU3ltYm9sIDogZnVuY3Rpb24gKGkpIHsKICAgICAgICAgIHJldHVybiBpOwogICAgICAgIH0pLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbIkBAaXRlcmF0b3IiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsKICAgICAgICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsKICAgICAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICAgICAgfQogICAgICAgIHJldHVybiBhcnIyOwogICAgICB9CiAgICAgIHZhciBfcmVxdWlyZSA9IF9fd2VicGFja19yZXF1aXJlX18oIC8qISAuL0xvZ2dlciAqLyIuL25vZGVfbW9kdWxlcy93ZWJwYWNrL2xpYi9sb2dnaW5nL0xvZ2dlci5qcyIpLAogICAgICAgIExvZ1R5cGUgPSBfcmVxdWlyZS5Mb2dUeXBlOwogICAgICAvKiogQHR5cGVkZWYge2ltcG9ydCgiLi4vLi4vZGVjbGFyYXRpb25zL1dlYnBhY2tPcHRpb25zIikuRmlsdGVySXRlbVR5cGVzfSBGaWx0ZXJJdGVtVHlwZXMgKi8KCiAgICAgIC8qKiBAdHlwZWRlZiB7aW1wb3J0KCIuLi8uLi9kZWNsYXJhdGlvbnMvV2VicGFja09wdGlvbnMiKS5GaWx0ZXJUeXBlc30gRmlsdGVyVHlwZXMgKi8KCiAgICAgIC8qKiBAdHlwZWRlZiB7aW1wb3J0KCIuL0xvZ2dlciIpLkxvZ1R5cGVFbnVtfSBMb2dUeXBlRW51bSAqLwoKICAgICAgLyoqIEB0eXBlZGVmIHtmdW5jdGlvbihzdHJpbmcpOiBib29sZWFufSBGaWx0ZXJGdW5jdGlvbiAqLwoKICAgICAgLyoqCiAgICAgICAqIEB0eXBlZGVmIHtPYmplY3R9IExvZ2dlckNvbnNvbGUKICAgICAgICogQHByb3BlcnR5IHtmdW5jdGlvbigpOiB2b2lkfSBjbGVhcgogICAgICAgKiBAcHJvcGVydHkge2Z1bmN0aW9uKCk6IHZvaWR9IHRyYWNlCiAgICAgICAqIEBwcm9wZXJ0eSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkfSBpbmZvCiAgICAgICAqIEBwcm9wZXJ0eSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkfSBsb2cKICAgICAgICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWR9IHdhcm4KICAgICAgICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWR9IGVycm9yCiAgICAgICAqIEBwcm9wZXJ0eSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkPX0gZGVidWcKICAgICAgICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBncm91cAogICAgICAgKiBAcHJvcGVydHkgeyguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZD19IGdyb3VwQ29sbGFwc2VkCiAgICAgICAqIEBwcm9wZXJ0eSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkPX0gZ3JvdXBFbmQKICAgICAgICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBzdGF0dXMKICAgICAgICogQHByb3BlcnR5IHsoLi4uYXJnczogYW55W10pID0+IHZvaWQ9fSBwcm9maWxlCiAgICAgICAqIEBwcm9wZXJ0eSB7KC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkPX0gcHJvZmlsZUVuZAogICAgICAgKiBAcHJvcGVydHkgeyguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZD19IGxvZ1RpbWUKICAgICAgICovCgogICAgICAvKioKICAgICAgICogQHR5cGVkZWYge09iamVjdH0gTG9nZ2VyT3B0aW9ucwogICAgICAgKiBAcHJvcGVydHkge2ZhbHNlfHRydWV8Im5vbmUifCJlcnJvciJ8Indhcm4ifCJpbmZvInwibG9nInwidmVyYm9zZSJ9IGxldmVsIGxvZ2xldmVsCiAgICAgICAqIEBwcm9wZXJ0eSB7RmlsdGVyVHlwZXN8Ym9vbGVhbn0gZGVidWcgZmlsdGVyIGZvciBkZWJ1ZyBsb2dnaW5nCiAgICAgICAqIEBwcm9wZXJ0eSB7TG9nZ2VyQ29uc29sZX0gY29uc29sZSB0aGUgY29uc29sZSB0byBsb2cgdG8KICAgICAgICovCgogICAgICAvKioKICAgICAgICogQHBhcmFtIHtGaWx0ZXJJdGVtVHlwZXN9IGl0ZW0gYW4gaW5wdXQgaXRlbQogICAgICAgKiBAcmV0dXJucyB7RmlsdGVyRnVuY3Rpb259IGZpbHRlciBmdW5jdGlvbgogICAgICAgKi8KCiAgICAgIHZhciBmaWx0ZXJUb0Z1bmN0aW9uID0gZnVuY3Rpb24gZmlsdGVyVG9GdW5jdGlvbihpdGVtKSB7CiAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAic3RyaW5nIikgewogICAgICAgICAgdmFyIHJlZ0V4cCA9IG5ldyBSZWdFeHAoIltcXFxcL10iLmNvbmNhdChpdGVtLnJlcGxhY2UoCiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdXNlbGVzcy1lc2NhcGUKICAgICAgICAgIC9bLVtcXXt9KCkqKz8uXFxeJHxdL2csICJcXCQmIiksICIoW1xcXFwvXXwkfCF8XFw/KSIpKTsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoaWRlbnQpIHsKICAgICAgICAgICAgcmV0dXJuIHJlZ0V4cC50ZXN0KGlkZW50KTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGlmIChpdGVtICYmIHR5cGVvZiBpdGVtID09PSAib2JqZWN0IiAmJiB0eXBlb2YgaXRlbS50ZXN0ID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGlkZW50KSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRlc3QoaWRlbnQpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIC8qKgogICAgICAgKiBAZW51bSB7bnVtYmVyfQogICAgICAgKi8KCiAgICAgIHZhciBMb2dMZXZlbCA9IHsKICAgICAgICBub25lOiA2LAogICAgICAgIGZhbHNlOiA2LAogICAgICAgIGVycm9yOiA1LAogICAgICAgIHdhcm46IDQsCiAgICAgICAgaW5mbzogMywKICAgICAgICBsb2c6IDIsCiAgICAgICAgdHJ1ZTogMiwKICAgICAgICB2ZXJib3NlOiAxCiAgICAgIH07CiAgICAgIC8qKgogICAgICAgKiBAcGFyYW0ge0xvZ2dlck9wdGlvbnN9IG9wdGlvbnMgb3B0aW9ucyBvYmplY3QKICAgICAgICogQHJldHVybnMge2Z1bmN0aW9uKHN0cmluZywgTG9nVHlwZUVudW0sIGFueVtdKTogdm9pZH0gbG9nZ2luZyBmdW5jdGlvbgogICAgICAgKi8KCiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICB2YXIgX3JlZiRsZXZlbCA9IF9yZWYubGV2ZWwsCiAgICAgICAgICBsZXZlbCA9IF9yZWYkbGV2ZWwgPT09IHZvaWQgMCA/ICJpbmZvIiA6IF9yZWYkbGV2ZWwsCiAgICAgICAgICBfcmVmJGRlYnVnID0gX3JlZi5kZWJ1ZywKICAgICAgICAgIGRlYnVnID0gX3JlZiRkZWJ1ZyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmJGRlYnVnLAogICAgICAgICAgY29uc29sZSA9IF9yZWYuY29uc29sZTsKICAgICAgICB2YXIgZGVidWdGaWx0ZXJzID0gdHlwZW9mIGRlYnVnID09PSAiYm9vbGVhbiIgPyBbZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIGRlYnVnOwogICAgICAgIH1dIDogLyoqIEB0eXBlIHtGaWx0ZXJJdGVtVHlwZXNbXX0gKi8KICAgICAgICBbXS5jb25jYXQoZGVidWcpLm1hcChmaWx0ZXJUb0Z1bmN0aW9uKTsKICAgICAgICAvKiogQHR5cGUge251bWJlcn0gKi8KCiAgICAgICAgdmFyIGxvZ2xldmVsID0gTG9nTGV2ZWxbIiIuY29uY2F0KGxldmVsKV0gfHwgMDsKICAgICAgICAvKioKICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBuYW1lIG9mIHRoZSBsb2dnZXIKICAgICAgICAgKiBAcGFyYW0ge0xvZ1R5cGVFbnVtfSB0eXBlIHR5cGUgb2YgdGhlIGxvZyBlbnRyeQogICAgICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3MgYXJndW1lbnRzIG9mIHRoZSBsb2cgZW50cnkKICAgICAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAgICAgKi8KCiAgICAgICAgdmFyIGxvZ2dlciA9IGZ1bmN0aW9uIGxvZ2dlcihuYW1lLCB0eXBlLCBhcmdzKSB7CiAgICAgICAgICB2YXIgbGFiZWxlZEFyZ3MgPSBmdW5jdGlvbiBsYWJlbGVkQXJncygpIHsKICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJncykpIHsKICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAwICYmIHR5cGVvZiBhcmdzWzBdID09PSAic3RyaW5nIikgewogICAgICAgICAgICAgICAgcmV0dXJuIFsiWyIuY29uY2F0KG5hbWUsICJdICIpLmNvbmNhdChhcmdzWzBdKV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhcmdzLnNsaWNlKDEpKSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBbIlsiLmNvbmNhdChuYW1lLCAiXSIpXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgdmFyIGRlYnVnID0gZGVidWdGaWx0ZXJzLnNvbWUoZnVuY3Rpb24gKGYpIHsKICAgICAgICAgICAgcmV0dXJuIGYobmFtZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgICAgICBjYXNlIExvZ1R5cGUuZGVidWc6CiAgICAgICAgICAgICAgaWYgKCFkZWJ1ZykgcmV0dXJuOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm9kZS9uby11bnN1cHBvcnRlZC1mZWF0dXJlcy9ub2RlLWJ1aWx0aW5zCgogICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5kZWJ1ZyA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGlucwogICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1Zy5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBMb2dUeXBlLmxvZzoKICAgICAgICAgICAgICBpZiAoIWRlYnVnICYmIGxvZ2xldmVsID4gTG9nTGV2ZWwubG9nKSByZXR1cm47CiAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBMb2dUeXBlLmluZm86CiAgICAgICAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLmluZm8pIHJldHVybjsKICAgICAgICAgICAgICBjb25zb2xlLmluZm8uYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBMb2dUeXBlLndhcm46CiAgICAgICAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLndhcm4pIHJldHVybjsKICAgICAgICAgICAgICBjb25zb2xlLndhcm4uYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBMb2dUeXBlLmVycm9yOgogICAgICAgICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5lcnJvcikgcmV0dXJuOwogICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IuYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBMb2dUeXBlLnRyYWNlOgogICAgICAgICAgICAgIGlmICghZGVidWcpIHJldHVybjsKICAgICAgICAgICAgICBjb25zb2xlLnRyYWNlKCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTG9nVHlwZS5ncm91cENvbGxhcHNlZDoKICAgICAgICAgICAgICBpZiAoIWRlYnVnICYmIGxvZ2xldmVsID4gTG9nTGV2ZWwubG9nKSByZXR1cm47CiAgICAgICAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLnZlcmJvc2UpIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnMKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5ncm91cENvbGxhcHNlZCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm9kZS9uby11bnN1cHBvcnRlZC1mZWF0dXJlcy9ub2RlLWJ1aWx0aW5zCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQuYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBmYWxscyB0aHJvdWdoCgogICAgICAgICAgICBjYXNlIExvZ1R5cGUuZ3JvdXA6CiAgICAgICAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLmxvZykgcmV0dXJuOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm9kZS9uby11bnN1cHBvcnRlZC1mZWF0dXJlcy9ub2RlLWJ1aWx0aW5zCgogICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5ncm91cCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGlucwogICAgICAgICAgICAgICAgY29uc29sZS5ncm91cC5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBMb2dUeXBlLmdyb3VwRW5kOgogICAgICAgICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5sb2cpIHJldHVybjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGlucwoKICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuZ3JvdXBFbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnMKICAgICAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTG9nVHlwZS50aW1lOgogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5sb2cpIHJldHVybjsKICAgICAgICAgICAgICAgIHZhciBtcyA9IGFyZ3NbMV0gKiAxMDAwICsgYXJnc1syXSAvIDEwMDAwMDA7CiAgICAgICAgICAgICAgICB2YXIgbXNnID0gIlsiLmNvbmNhdChuYW1lLCAiXSAiKS5jb25jYXQoYXJnc1swXSwgIjogIikuY29uY2F0KG1zLCAiIG1zIik7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUubG9nVGltZSA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZ1RpbWUobXNnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgTG9nVHlwZS5wcm9maWxlOgogICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnMKICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUucHJvZmlsZSA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGlucwogICAgICAgICAgICAgICAgY29uc29sZS5wcm9maWxlLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIExvZ1R5cGUucHJvZmlsZUVuZDoKICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm9kZS9uby11bnN1cHBvcnRlZC1mZWF0dXJlcy9ub2RlLWJ1aWx0aW5zCiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLnByb2ZpbGVFbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnMKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJvZmlsZUVuZC5hcHBseShjb25zb2xlLCBfdG9Db25zdW1hYmxlQXJyYXkobGFiZWxlZEFyZ3MoKSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBMb2dUeXBlLmNsZWFyOgogICAgICAgICAgICAgIGlmICghZGVidWcgJiYgbG9nbGV2ZWwgPiBMb2dMZXZlbC5sb2cpIHJldHVybjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vZGUvbm8tdW5zdXBwb3J0ZWQtZmVhdHVyZXMvbm9kZS1idWlsdGlucwoKICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuY2xlYXIgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL25vZGUtYnVpbHRpbnMKICAgICAgICAgICAgICAgIGNvbnNvbGUuY2xlYXIoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTG9nVHlwZS5zdGF0dXM6CiAgICAgICAgICAgICAgaWYgKCFkZWJ1ZyAmJiBsb2dsZXZlbCA+IExvZ0xldmVsLmluZm8pIHJldHVybjsKICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuc3RhdHVzID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5zdGF0dXMoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuc3RhdHVzLmFwcGx5KGNvbnNvbGUsIF90b0NvbnN1bWFibGVBcnJheShsYWJlbGVkQXJncygpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8uYXBwbHkoY29uc29sZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxhYmVsZWRBcmdzKCkpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIExvZ1R5cGUgIi5jb25jYXQodHlwZSkpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgcmV0dXJuIGxvZ2dlcjsKICAgICAgfTsKCiAgICAgIC8qKiovCiAgICB9LAoKICAgIC8qKiovIi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvcnVudGltZS5qcyI6CiAgICAvKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICAgICAhKioqIC4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvcnVudGltZS5qcyAqKiohCiAgICAgIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIC8qKiovCiAgICBmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgLyoKICAgICAgCU1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwCiAgICAgIAlBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhCiAgICAgICovCgogICAgICBmdW5jdGlvbiBfZXh0ZW5kcygpIHsKICAgICAgICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gPyBPYmplY3QuYXNzaWduLmJpbmQoKSA6IGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsKICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgewogICAgICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB0YXJnZXQ7CiAgICAgICAgfTsKICAgICAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgICB2YXIgU3luY0JhaWxIb29rID0gX193ZWJwYWNrX3JlcXVpcmVfXyggLyohIHRhcGFibGUvbGliL1N5bmNCYWlsSG9vayAqLyIuL2NsaWVudC1zcmMvbW9kdWxlcy9sb2dnZXIvU3luY0JhaWxIb29rRmFrZS5qcyIpOwogICAgICB2YXIgX3JlcXVpcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCAvKiEgLi9Mb2dnZXIgKi8iLi9ub2RlX21vZHVsZXMvd2VicGFjay9saWIvbG9nZ2luZy9Mb2dnZXIuanMiKSwKICAgICAgICBMb2dnZXIgPSBfcmVxdWlyZS5Mb2dnZXI7CiAgICAgIHZhciBjcmVhdGVDb25zb2xlTG9nZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXyggLyohIC4vY3JlYXRlQ29uc29sZUxvZ2dlciAqLyIuL25vZGVfbW9kdWxlcy93ZWJwYWNrL2xpYi9sb2dnaW5nL2NyZWF0ZUNvbnNvbGVMb2dnZXIuanMiKTsKICAgICAgLyoqIEB0eXBlIHtjcmVhdGVDb25zb2xlTG9nZ2VyLkxvZ2dlck9wdGlvbnN9ICovCgogICAgICB2YXIgY3VycmVudERlZmF1bHRMb2dnZXJPcHRpb25zID0gewogICAgICAgIGxldmVsOiAiaW5mbyIsCiAgICAgICAgZGVidWc6IGZhbHNlLAogICAgICAgIGNvbnNvbGU6IGNvbnNvbGUKICAgICAgfTsKICAgICAgdmFyIGN1cnJlbnREZWZhdWx0TG9nZ2VyID0gY3JlYXRlQ29uc29sZUxvZ2dlcihjdXJyZW50RGVmYXVsdExvZ2dlck9wdGlvbnMpOwogICAgICAvKioKICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgbmFtZSBvZiB0aGUgbG9nZ2VyCiAgICAgICAqIEByZXR1cm5zIHtMb2dnZXJ9IGEgbG9nZ2VyCiAgICAgICAqLwoKICAgICAgZXhwb3J0cy5nZXRMb2dnZXIgPSBmdW5jdGlvbiAobmFtZSkgewogICAgICAgIHJldHVybiBuZXcgTG9nZ2VyKGZ1bmN0aW9uICh0eXBlLCBhcmdzKSB7CiAgICAgICAgICBpZiAoZXhwb3J0cy5ob29rcy5sb2cuY2FsbChuYW1lLCB0eXBlLCBhcmdzKSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGN1cnJlbnREZWZhdWx0TG9nZ2VyKG5hbWUsIHR5cGUsIGFyZ3MpOwogICAgICAgICAgfQogICAgICAgIH0sIGZ1bmN0aW9uIChjaGlsZE5hbWUpIHsKICAgICAgICAgIHJldHVybiBleHBvcnRzLmdldExvZ2dlcigiIi5jb25jYXQobmFtZSwgIi8iKS5jb25jYXQoY2hpbGROYW1lKSk7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICAgIC8qKgogICAgICAgKiBAcGFyYW0ge2NyZWF0ZUNvbnNvbGVMb2dnZXIuTG9nZ2VyT3B0aW9uc30gb3B0aW9ucyBuZXcgb3B0aW9ucywgbWVyZ2Ugd2l0aCBvbGQgb3B0aW9ucwogICAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAgICovCgogICAgICBleHBvcnRzLmNvbmZpZ3VyZURlZmF1bHRMb2dnZXIgPSBmdW5jdGlvbiAob3B0aW9ucykgewogICAgICAgIF9leHRlbmRzKGN1cnJlbnREZWZhdWx0TG9nZ2VyT3B0aW9ucywgb3B0aW9ucyk7CiAgICAgICAgY3VycmVudERlZmF1bHRMb2dnZXIgPSBjcmVhdGVDb25zb2xlTG9nZ2VyKGN1cnJlbnREZWZhdWx0TG9nZ2VyT3B0aW9ucyk7CiAgICAgIH07CiAgICAgIGV4cG9ydHMuaG9va3MgPSB7CiAgICAgICAgbG9nOiBuZXcgU3luY0JhaWxIb29rKFsib3JpZ2luIiwgInR5cGUiLCAiYXJncyJdKQogICAgICB9OwoKICAgICAgLyoqKi8KICAgIH0KCiAgICAvKioqKioqLwogIH07CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAvKioqKioqLyAvLyBUaGUgbW9kdWxlIGNhY2hlCiAgLyoqKioqKi8KICB2YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307CiAgLyoqKioqKi8KICAvKioqKioqLyAvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgogIC8qKioqKiovCiAgZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewogICAgLyoqKioqKi8gLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCiAgICAvKioqKioqL3ZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwogICAgLyoqKioqKi8KICAgIGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewogICAgICAvKioqKioqL3JldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0czsKICAgICAgLyoqKioqKi8KICAgIH0KICAgIC8qKioqKiovIC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCiAgICAvKioqKioqLwogICAgdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7CiAgICAgIC8qKioqKiovIC8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKICAgICAgLyoqKioqKi8gLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKICAgICAgLyoqKioqKi9leHBvcnRzOiB7fQogICAgICAvKioqKioqLwogICAgfTsKICAgIC8qKioqKiovCiAgICAvKioqKioqLyAvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KICAgIC8qKioqKiovCiAgICBfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKICAgIC8qKioqKiovCiAgICAvKioqKioqLyAvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQogICAgLyoqKioqKi8KICAgIHJldHVybiBtb2R1bGUuZXhwb3J0czsKICAgIC8qKioqKiovCiAgfQogIC8qKioqKiovCiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAvKioqKioqLyAvKiB3ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMgKi8KICAvKioqKioqLwogICFmdW5jdGlvbiAoKSB7CiAgICAvKioqKioqLyAvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzCiAgICAvKioqKioqL19fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uIChleHBvcnRzLCBkZWZpbml0aW9uKSB7CiAgICAgIC8qKioqKiovZm9yICh2YXIga2V5IGluIGRlZmluaXRpb24pIHsKICAgICAgICAvKioqKioqL2lmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHsKICAgICAgICAgIC8qKioqKiovT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQ6IGRlZmluaXRpb25ba2V5XQogICAgICAgICAgfSk7CiAgICAgICAgICAvKioqKioqLwogICAgICAgIH0KICAgICAgICAvKioqKioqLwogICAgICB9CiAgICAgIC8qKioqKiovCiAgICB9OwogICAgLyoqKioqKi8KICB9KCk7CiAgLyoqKioqKi8KICAvKioqKioqLyAvKiB3ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kICovCiAgLyoqKioqKi8KICAhZnVuY3Rpb24gKCkgewogICAgLyoqKioqKi9fX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbiAob2JqLCBwcm9wKSB7CiAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsKICAgIH07CiAgICAvKioqKioqLwogIH0oKTsKICAvKioqKioqLwogIC8qKioqKiovIC8qIHdlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QgKi8KICAvKioqKioqLwogICFmdW5jdGlvbiAoKSB7CiAgICAvKioqKioqLyAvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzCiAgICAvKioqKioqL19fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAgIC8qKioqKiovaWYgKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykgewogICAgICAgIC8qKioqKiovT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgewogICAgICAgICAgdmFsdWU6ICdNb2R1bGUnCiAgICAgICAgfSk7CiAgICAgICAgLyoqKioqKi8KICAgICAgfQogICAgICAvKioqKioqLwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7CiAgICAgICAgdmFsdWU6IHRydWUKICAgICAgfSk7CiAgICAgIC8qKioqKiovCiAgICB9OwogICAgLyoqKioqKi8KICB9KCk7CiAgLyoqKioqKi8KICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogIHZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0ge307CiAgLy8gVGhpcyBlbnRyeSBuZWVkIHRvIGJlIHdyYXBwZWQgaW4gYW4gSUlGRSBiZWNhdXNlIGl0IG5lZWQgdG8gYmUgaXNvbGF0ZWQgYWdhaW5zdCBvdGhlciBtb2R1bGVzIGluIHRoZSBjaHVuay4KICAhZnVuY3Rpb24gKCkgewogICAgLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAgICAgISoqKiAuL2NsaWVudC1zcmMvbW9kdWxlcy9sb2dnZXIvaW5kZXguanMgKioqIQogICAgICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnIoX193ZWJwYWNrX2V4cG9ydHNfXyk7CiAgICAvKiBoYXJtb255IGV4cG9ydCAqLwogICAgX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIHsKICAgICAgLyogaGFybW9ueSBleHBvcnQgKi8iZGVmYXVsdCI6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gKC8qIHJlZXhwb3J0IGRlZmF1bHQgZXhwb3J0IGZyb20gbmFtZWQgbW9kdWxlICovd2VicGFja19saWJfbG9nZ2luZ19ydW50aW1lX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18KICAgICAgICApOwogICAgICB9CiAgICAgIC8qIGhhcm1vbnkgZXhwb3J0ICovCiAgICB9KTsKICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovCiAgICB2YXIgd2VicGFja19saWJfbG9nZ2luZ19ydW50aW1lX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCAvKiEgd2VicGFjay9saWIvbG9nZ2luZy9ydW50aW1lLmpzICovIi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svbGliL2xvZ2dpbmcvcnVudGltZS5qcyIpOwogIH0oKTsKICB2YXIgX193ZWJwYWNrX2V4cG9ydF90YXJnZXRfXyA9IGV4cG9ydHM7CiAgZm9yICh2YXIgaSBpbiBfX3dlYnBhY2tfZXhwb3J0c19fKSBfX3dlYnBhY2tfZXhwb3J0X3RhcmdldF9fW2ldID0gX193ZWJwYWNrX2V4cG9ydHNfX1tpXTsKICBpZiAoX193ZWJwYWNrX2V4cG9ydHNfXy5fX2VzTW9kdWxlKSBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX2V4cG9ydF90YXJnZXRfXywgIl9fZXNNb2R1bGUiLCB7CiAgICB2YWx1ZTogdHJ1ZQogIH0pOwogIC8qKioqKiovCn0pKCk7"},null]}